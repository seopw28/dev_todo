# 개발 일지 - 2025-11-02

## 주요 개발 내용 요약

### 1. 탭 구조 변경
- **변경**: "전체", "활성", "완료" → "할일", "완료", "휴지통"
- **목적**: 더 직관적인 UI와 휴지통 기능 분리

### 2. 휴지통 기능 구현
- **구현 내용**:
  - `deleted` 필드로 삭제된 항목 관리
  - 휴지통 탭에서 삭제된 항목만 표시
  - 휴지통에서 완전 삭제 기능
  - "휴지통 비우기" 버튼 추가
  
### 3. 삭제 로직 개선
- **할일/완료 탭**: 확인 없이 바로 휴지통으로 이동
- **휴지통 탭**: 확인 후 완전 삭제
- 휴지통 항목은 완료/수정 불가 처리

### 4. 커스텀 모달 구현
- **변경**: 브라우저 기본 `confirm()` → 다크 모드 커스텀 모달
- **기능**: 
  - 배경 블러 효과
  - ESC 키/배경 클릭으로 취소
  - Promise 기반 비동기 처리
  - 애니메이션 효과

### 5. 렌더링 최적화
- **문제**: 할일 추가 시 반짝임 현상
- **해결**:
  - Debounce 적용 (50ms 내 연속 렌더링 묶음)
  - HTML 캐싱으로 불필요한 DOM 업데이트 방지
  - `requestAnimationFrame`으로 렌더링 사이클 최적화
  - CSS 애니메이션(`slideIn`) 제거

### 6. UI 개선
- 휴지통 탭 활성 시 파란색 밑줄 제거 (`border-bottom-color: transparent`)
- 드래그 앤 드롭 기능 제거 (작동 불안정)
- 클릭 이벤트 단순화 (상세 페이지 열기만 유지)

---

## 기술적 변경 사항

### 파일 변경
- `index.html`: 탭 구조 변경, 커스텀 모달 추가
- `script-firestore.js`: 
  - 필터링 로직 개선 (`getFilteredTodos`)
  - 삭제 로직 분리 (`deleteTodo`)
  - 휴지통 비우기 함수 추가 (`emptyTrash`)
  - 커스텀 모달 함수 추가 (`showModal`)
  - 렌더링 최적화 (`debouncedRenderTodos`, HTML 캐싱)
  - 드래그 앤 드롭 기능 제거
- `style.css`: 
  - 모달 스타일 추가
  - 탭 활성 상태 스타일 수정
  - 드래그 관련 스타일 제거

### Firestore 스키마
- `deleted`: boolean (휴지통 관리)
- `deletedAt`: timestamp (삭제 시각)

---

## 추가 개발 내용 (후반부)

### 7. Font Awesome 아이콘 라이브러리 통합
- **목적**: 이모지 대신 고품질 아이콘 사용
- **구현**:
  - Font Awesome 6.5.1 CDN 추가 (모든 HTML 파일)
  - 네비게이션 아이콘 교체: 📝→`fa-clipboard-list`, 💖→`fa-heart`, 🌤️→`fa-cloud-sun`
  - To Do 페이지 버튼 아이콘: ✎→`fa-pencil-alt`, 🗑→`fa-trash`
  - 설정 버튼: ⚙️→`fa-cog`
  - 캐릭터 선택 바 아이콘도 Font Awesome으로 자동 변환
- **파일**: `index.html`, `weather/index.html`, `chiko/index.html`, `chiko/script.js`, `script-firestore.js`, `style.css`, `chiko/style.css`

### 8. 치코 AI 채팅 서비스 구현
- **기능**: Gemini API를 활용한 1:1 AI 채팅 서비스
- **구현 내용**:
  - Gemini 2.5 Flash 모델 사용
  - 시스템 프롬프트를 통한 캐릭터 설정
  - API 키 관리 시스템 (기본 키 + 사용자 개인 키)
  - 설정 모달을 통한 API 키 입력
  - localStorage에 개인 키 저장
- **파일**: `chiko/index.html`, `chiko/style.css`, `chiko/script.js`, `chiko/config.js`

### 9. 캐릭터 모드 시스템
- **구현**: 4가지 캐릭터 모드 제공
  - 연인: 로맨틱한 분위기
  - 비서: 극존칭 사용
  - 의사: 전문적 의료 조언
  - 친구: 편안한 반말 톤
- **기능**:
  - 캐릭터 선택 바 UI (가로 스크롤)
  - 선택된 캐릭터에 따른 시스템 프롬프트 자동 변경
  - localStorage에 선택 저장
  - 캐릭터별 인사 메시지 자동 변경
- **파일**: `chiko/characters.js`, `chiko/script.js`, `chiko/style.css`

### 10. 역할별 배경 이미지 시스템
- **구현**: Unsplash Source를 활용한 동적 배경 이미지
- **특징**:
  - API 키 불필요, 바로 사용 가능
  - 역할별 적절한 이미지 자동 로드
  - 투명도 15%로 텍스트 가독성 유지
  - 부드러운 전환 애니메이션 (0.5s)
- **배경 매핑**:
  - 연인: 로맨틱/핑크 계열
  - 비서: 사무실/블루 계열
  - 의사: 병원/화이트 계열
  - 친구: 웃음/그린 계열
- **파일**: `chiko/style.css`, `chiko/script.js`, `chiko/background-images.md`

### 11. 네비게이션 개선
- **순서 변경**: To Do | 치코 | 날씨 → **날씨 | 치코 | To Do**
- **아이콘 개선**: 모든 페이지에 Font Awesome 아이콘 적용
- **아이콘 변경**: 치코 아이콘 🐱 → 💖 (하트)

### 12. 문서화
- **생성 파일**:
  - `icons-setup.md`: 아이콘 라이브러리 가이드
  - `chiko/API_SETUP.md`: Gemini API 설정 가이드
  - `chiko/background-images.md`: 무료 배경 이미지 소스 가이드

---

## 기술 스택 추가
- **Font Awesome 6.5.1**: 아이콘 라이브러리 (CDN)
- **Gemini API 2.5 Flash**: AI 채팅 모델
- **Unsplash Source**: 무료 배경 이미지

---

## 추가 개발 내용 (최근 업데이트)

### 13. To Do 페이지 UI 개선
- **완료/휴지통 탭 입력 UI 제거**: 
  - 할일 탭에서만 입력 필드와 + 버튼 표시
  - 완료 탭과 휴지통 탭에서는 입력 UI 숨김
- **빈 상태 메시지 일관성**: 
  - 휴지통 탭: "삭제된 메모가 없습니다." → "삭제된 To Do가 없습니다."
- **토스트 팝업 개선**:
  - 너비 증가: min-width 300px → 320px, max-width 400px → 500px
  - 표시 시간: 1초 → 1.5초로 변경
  - 단어 단위 줄바꿈 (`word-break: keep-all`) 적용
- **파일**: `script-firestore.js`, `style.css`

### 14. 대화(치코) 페이지 메시지 삭제 기능
- **길게 누르기 삭제**:
  - 사용자 메시지와 AI 메시지 모두 삭제 가능
  - 길게 누르는 시간: 0.7초
  - 삭제 확인 모달 표시 후 삭제 실행
- **삭제 확인 모달 레이아웃**:
  - 상단: 취소(좌측) | 확인(우측) 버튼 가로 배치
  - 하단: "현 채팅방 초기화" 버튼 전체 너비
- **채팅방 초기화 기능**:
  - 현재 캐릭터의 모든 채팅 히스토리 삭제
  - localStorage에서 해당 캐릭터의 데이터 제거
  - 인사 메시지만 남기고 화면 초기화
- **시각적 피드백**:
  - 모든 메시지에 포인터 커서 적용
  - 텍스트 선택 방지 (`user-select: none`)
  - 삭제 시 페이드아웃 애니메이션
- **파일**: `chiko/script.js`, `chiko/style.css`, `chiko/index.html`

### 15. 폰트 및 타이포그래피 개선
- **Pretendard 폰트 적용**: 
  - Toss, Gmarket Sans와 유사한 모던 폰트
  - 모든 페이지에 일괄 적용
  - CDN: `cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9`
- **타이포그래피 정제**:
  - 폰트 크기, 줄 간격, 자간 조정
  - 헤더, 본문, 모달, 토스트 등 모든 요소에 적용
- **파일**: `index.html`, `weather/index.html`, `chiko/index.html`, `style.css`, `weather/style.css`, `chiko/style.css`

### 16. 날씨 페이지 아이콘 개선
- **Font Awesome 날씨 아이콘**:
  - 기존 정적 이미지 → Font Awesome 동적 아이콘
  - 날씨 조건에 따른 아이콘 자동 변경
  - 시간대별 아이콘 (낮: 태양, 밤: 달)
  - 아이콘 색상 자동 조정 (태양: 노란색, 비: 파란색 등)
- **함수**:
  - `getWeatherIconClass()`: 날씨 조건 → Font Awesome 클래스 매핑
  - `getWeatherIconColor()`: 아이콘 클래스 → 색상 매핑
- **파일**: `weather/script.js`, `weather/style.css`, `weather/index.html`

---

## 추가 개발 내용 (모바일 웹 브라우저 최적화)

### 17. 상태바 제거 및 헤더 최적화
- **날씨 페이지**:
  - 상태바(시계, 배터리) 완전 제거
  - 헤더를 최상단(`top: 0`)에 배치
  - 헤더 높이 축소: 68px → 52px (min-height: 44px)
  - 헤더 상하 패딩 축소: 12px → 8px
  - iOS 노치 영역 대응: `env(safe-area-inset-top)` 적용
- **대화 페이지**:
  - 상태바 완전 제거 (HTML, CSS, JavaScript)
  - 헤더 최상단 배치 및 높이 축소
  - 헤더와 캐릭터 선택 바 경계선 제거로 연결감 강화
- **파일**: `weather/index.html`, `weather/style.css`, `weather/script.js`, `chiko/index.html`, `chiko/style.css`, `chiko/script.js`

### 18. 네비게이션 바 최적화
- **높이 축소**:
  - 최소 높이: 70px → 44px
  - 상하 패딩: 12px → 4px
- **글자 크기 축소**:
  - 라벨 폰트: 12px → 10px
- **모든 페이지에 일관 적용**: 날씨, 대화, To Do 페이지
- **파일**: `style.css`, `weather/style.css`

### 19. 대화 페이지 타입 선택 칩 개선
- **위치 최적화**:
  - 헤더 바로 아래에 고정 배치 (`position: fixed`)
  - 콘텐츠 영역과 연결감 강화 (경계선 제거, 배경색 통일)
- **반응형 간격**:
  - `gap: clamp(8px, 2vw, 16px)` - 화면 크기에 따른 동적 간격
  - `justify-content: space-around` - 칩 균등 분배
  - 좌우 패딩도 `clamp()`로 반응형 적용
- **칩 크기 자동 조절**:
  - `flex: 1` 적용으로 화면 너비에 맞춰 자동 조절
  - `min-width: 70px`, `max-width: 120px`로 제한
- **파일**: `chiko/style.css`

### 20. To Do 페이지 헤더 축소
- **기존**: 큰 파란색 헤더 영역 (padding: 30px)
- **변경**: 얇은 파란색 띠 형태 (padding: 12px 20px)
- **폰트 크기**: 2.2em → 1.2em
- **subtitle 제거**: "오늘의 일정을 체계적으로 관리하세요" 제거
- **min-height**: 44px로 설정하여 컴팩트한 디자인
- **파일**: `index.html`, `style.css`

### 21. 모바일 웹 브라우저 환경 대응
- **문제 인식**: 
  - 모바일 크롬 브라우저에서 상단 URL 주소창과 하단 브라우저 옵션 바로 인한 화면 영역 축소
- **해결 방안**:
  1. **동적 뷰포트 높이 적용**:
     - 모든 페이지에 `100vh` → `100dvh` 변경
     - 브라우저 주소창 표시/숨김에 자동 대응
  2. **하단 브라우저 옵션 바 고려**:
     - 네비게이션 바 `padding-bottom`: `max(44px, env(safe-area-inset-bottom) + 44px)`
     - 브라우저 옵션 바(44px) + 네비게이션 바(44px) = 총 88px 공간 확보
  3. **Viewport 메타 태그 개선**:
     - `viewport-fit=cover` 추가 (모든 페이지)
     - `user-scalable=no` 추가
     - `theme-color` 설정으로 브라우저 UI 색상 통일
  4. **일관된 패딩 정책**:
     - 날씨 페이지: `padding-bottom: max(88px, env(safe-area-inset-bottom) + 88px)`
     - 대화 페이지: 채팅 입력창 하단 패딩 88px 고려
     - To Do 페이지: body 패딩 조정
- **적용 페이지**: 모든 페이지 (날씨, 대화, To Do)
- **파일**: 
  - `index.html`, `weather/index.html`, `chiko/index.html`
  - `style.css`, `weather/style.css`, `chiko/style.css`

### 22. 전체 UI/UX 정제
- **일관성 확보**:
  - 모든 페이지에 동일한 하단 여백 계산 로직 적용
  - 브라우저 UI와 겹치지 않도록 z-index 및 위치 조정
  - 경계선 제거로 시각적 연결감 강화
- **공간 효율성**:
  - 불필요한 여백 제거
  - 컴팩트한 헤더 디자인
  - 최소한의 높이로 최대 콘텐츠 공간 확보
- **반응형 디자인**:
  - 화면 크기에 따른 동적 간격 조절
  - 뷰포트 단위(`vw`, `dvh`) 적극 활용
- **접근성**:
  - safe-area-inset으로 노치/홈 인디케이터 영역 고려
  - 터치 영역 최소 44px 확보

---

## 추가 개발 내용 (UI/UX 통일 및 대화 도메인 재설계)

### 23. 네비게이션 바 통일 및 높이 조정
- **높이 통일**:
  - 모든 도메인에서 네비게이션 바 높이 통일: 44px → 56px
  - 상하 패딩 증가: 4px → 10px
  - 날씨 도메인 네비게이션 바 스타일 통일 (기존 별도 스타일 제거)
- **공간 확보**:
  - 네비게이션 바로 위 여백 제거
  - 모든 관련 레이어 위치 계산 업데이트
- **파일**: `style.css`, `weather/style.css`, `chiko/style.css`

### 24. To Do 페이지 헤더 제거 및 구조 개선
- **헤더 완전 제거**:
  - 기존 파란색 헤더 띠 완전 제거
  - 서브탭 네비게이션이 최상단에 직접 표시
- **레이아웃 조정**:
  - 컨테이너 마진 조정으로 헤더 없이도 정상 작동
- **파일**: `index.html`, `style.css`

### 25. 대화 도메인 UX 완전 재설계
- **레이어 구조 명확화**:
  1. **레이어 1**: 최상단 헤더 (고정, 40px)
  2. **레이어 2**: 대화타입 선택 레이어 (고정, 92px)
  3. **레이어 3**: 대화창 레이어 (스크롤 가능)
  4. **레이어 4**: 입력 영역 (고정, 80px, 키보드 대응)
  5. **레이어 5**: 하단 네비게이션 (고정, 공통)
- **Fixed 포지셔닝**:
  - 모든 레이어를 `position: fixed`로 독립적으로 고정
  - 각 레이어의 `top`, `bottom` 값을 정확히 계산하여 겹침 완전 방지
  - 키보드가 올라올 때도 자동 조정되도록 설정
- **HTML 구조 단순화**:
  - 입력 영역을 독립 레이어로 분리
  - 불필요한 중첩 제거
- **파일**: `chiko/index.html`, `chiko/style.css`

### 26. 대화타입 칩 UI 개선
- **크기 조정**:
  - 최대 너비: 60px → 70px
  - 최소 너비/높이: 50px → 60px
  - 정사각형 비율 유지 (`aspect-ratio: 1`)
- **내부 요소 크기 조정**:
  - 아이콘 크기: 1.2em → 1.4em
  - 텍스트 크기: 9px → 10px
  - 패딩 및 간격 증가
- **레이어 높이 조정**:
  - 칩 레이어 높이: 76px → 92px (칩 크기 증가에 맞춤)
  - 상하 패딩: 14px → 16px로 칩 상하단 여백 확보
- **파일**: `chiko/style.css`

### 27. 헤더 통일 작업
- **모든 도메인 헤더 통일**:
  - 높이: 40px (모든 도메인 동일)
  - 글자 크기: 1em (모든 도메인 동일)
  - 색상: 로열블루 (#4169E1) 통일
- **공통 스타일 정의**:
  - `style.css`에 공통 헤더 스타일 정의
  - 모든 도메인에서 공통 스타일 사용
  - To Do 도메인에 헤더 추가 (기존 헤더 제거 후 공통 헤더 사용)
- **날씨 도메인 헤더 구조 통일**:
  - HTML 구조를 대화 도메인과 동일하게 변경 (`<div class="app-header">`)
  - 공통 스타일시트(`../style.css`) 로드 추가
  - 기존 헤더 스타일 완전 제거
- **파일**: `style.css`, `chiko/style.css`, `weather/style.css`, `weather/index.html`, `index.html`

### 28. 헤더와 칩 레이어 사이 여백 제거
- **시각적 연결감 강화**:
  - 헤더 하단 경계선 제거 (`border-bottom: none`)
  - 헤더 그림자 제거 (`box-shadow: none`)
  - 칩 레이어 배경색을 body 배경과 동일하게 통일 (#1e1e1e → #0f0f0f)
  - 칩 레이어 하단 경계선 및 그림자 제거
- **결과**: 헤더와 칩 레이어가 하나의 연속된 영역처럼 보이도록 개선
- **파일**: `chiko/style.css`

